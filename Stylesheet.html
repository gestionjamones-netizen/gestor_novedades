<style>
  /* --- PALETA INSTITUCIONAL --- */
  :root {
    --primary-orange: #EE7623;
    --secondary-blue: #2B6AA9;
    --accent-green: #1D9A78;
    --bg-app: #f4f6f8;
    --bg-panel: #ffffff;
    --text-main: #2c3e50;
    --border: #dce1e6;
    --header-h: 70px; /* Aumentado ligeramente para los labels */
    --holiday-bg: #e2e8f0;
    --cell-h: 48px;
  }

  body {
    background: var(--bg-app);
    color: var(--text-main);
    font-family: 'Segoe UI', Roboto, Helvetica, sans-serif;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* --- TOP BAR --- */
  .top-bar {
    height: var(--header-h);
    background: var(--secondary-blue);
    padding: 0 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    z-index: 100;
  }

  .logo-area { display: flex; align-items: center; gap: 20px; }
  .logo { font-size: 1.1rem; font-weight: 700; color: white; display: flex; align-items: center; gap: 8px; }
  
  /* NUEVO: Grupos de control con Labels */
  .controls { display: flex; gap: 15px; align-items: center; }
  .control-group { display: flex; flex-direction: column; justify-content: center; }
  .control-group label { color: rgba(255,255,255,0.8); font-size: 0.65rem; text-transform: uppercase; margin-bottom: 2px; font-weight: 600; letter-spacing: 0.5px; }

  .select-wrapper { position: relative; background: rgba(255, 255, 255, 0.1); border-radius: 4px; }
  select.custom-select {
    background: transparent; color: white; border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 6px 24px 6px 10px; border-radius: 4px; font-size: 0.85rem; cursor: pointer;
    outline: none; appearance: none; min-width: 80px; text-align: center;
  }
  select.custom-select:focus { border-color: var(--primary-orange); background: var(--secondary-blue); }
  select.custom-select option { color: #333; background: white; }
  .select-arrow { position: absolute; right: 6px; top: 50%; transform: translateY(-50%); pointer-events: none; color: rgba(255, 255, 255, 0.7); font-size: 0.7rem; }

  .btn-load {
    background: var(--primary-orange); color: white; border: none; height: 34px; width: 34px;
    border-radius: 6px; display: flex; justify-content: center; align-items: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); transition: transform 0.1s;
  }
  .btn-load:active { transform: scale(0.95); }

  /* --- TABLA --- */
  .table-wrapper { height: calc(100vh - var(--header-h)); overflow: auto; background: white; }
  table { border-collapse: separate; border-spacing: 0; font-size: 0.75rem; width: 100%; }
  th, td { border-right: 1px solid var(--border); border-bottom: 1px solid var(--border); padding: 0; text-align: center; height: var(--cell-h); box-sizing: border-box; }

  /* HEADER STYLING */
  thead tr.tr-weeks th {
      position: sticky; top: 0; background: #eaedf1; color: #555;
      z-index: 20; height: 25px; font-size: 0.7rem; border-bottom: 1px solid #ccc;
      text-transform: uppercase; letter-spacing: 0.5px;
  }
  thead tr.tr-weeks th.week-header { border-right: 1px solid #ccc; background: #e0e4e8; color: var(--secondary-blue); font-weight: 700; }

  thead tr:nth-child(2) th {
    position: sticky; top: 25px; background: #f1f3f5; color: var(--text-main);
    z-index: 20; font-weight: 700; height: 48px; border-bottom: none;
  }
  thead tr:nth-child(2) th.day-header { cursor: pointer; }
  thead tr:nth-child(2) th.day-header:hover { background: #e2e8f0; color: var(--secondary-blue); }

  /* FILTERS ROW */
  thead tr:nth-child(3) th {
    position: sticky; top: 73px; background: #f8f9fa; z-index: 20;
    height: 35px; padding: 2px; box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.1);
  }

  .filter-input { width: 90%; border: 1px solid #ced4da; border-radius: 3px; font-size: 0.7rem; padding: 3px; text-align: center; background: white; }
  .filter-input:focus { border-color: var(--secondary-blue); outline: none; box-shadow: 0 0 0 2px rgba(43, 106, 169, 0.1); }

  /* Column widths */
  .col-contrato { width: 70px; min-width: 70px; }
  .col-registro { width: 60px; min-width: 60px; }
  .col-nombre { width: 180px; min-width: 180px; text-align: left; padding-left: 8px; }
  .col-puesto { width: 110px; min-width: 110px; font-size: 0.65rem; color: #666; text-align: left; padding-left: 4px; }
  .col-summary { width: 60px; min-width: 60px; font-weight: bold; background: #fffbe6; }
  .col-balance { width: 70px; min-width: 70px; font-weight: bold; }
  .col-comp { width: 60px; min-width: 60px; font-weight: bold; }

  .sticky-col { position: sticky; left: 0; background: white; z-index: 10; border-right: 2px solid var(--border); }
  th.sticky-col { z-index: 30; }
  .pos-1 { left: 0; }
  .pos-2 { left: 70px; }
  .pos-3 { left: 130px; }
  .pos-4 { left: 310px; }

  /* Cells & Markers */
  .day-cell { cursor: pointer; min-width: 45px; vertical-align: top; position: relative; padding: 1px; }
  .day-cell-content { display: flex; flex-direction: column; height: 100%; width: 100%; gap: 1px; overflow: hidden; }
  .day-cell:hover { background: #edf2f7; }
  .is-holiday, .is-holiday-header { background-color: var(--holiday-bg) !important; color: #555; }
  .is-holiday-header { color: #d32f2f; }

  .marker { flex: 1; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: bold; border-radius: 2px; overflow: hidden; min-height: 0; }
  .mk-nomina { background: #dbeafe; color: var(--secondary-blue); border-left: 3px solid var(--secondary-blue); font-size: 0.75rem; }
  .mk-permiso { background: #fdedec; color: #e74c3c; border-left: 3px solid #e74c3c; }
  .mk-pago { background: #eafaf1; color: #2ecc71; border-left: 3px solid #2ecc71; }
  .mk-otro { color: white; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.3); text-transform: uppercase; font-size: 0.6rem; }

  .debt-pos { color: #d32f2f; background: #ffebee; }
  .debt-neg { color: #198754; background: #d1e7dd; }
  .debt-zero { color: #aaa; }

  /* --- MODAL --- */
  .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 200; backdrop-filter: blur(2px); }
  .modal-box { background: white; width: 95%; max-width: 420px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 8px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); display: flex; flex-direction: column; max-height: 90vh; }
  .modal-header { padding: 12px 15px; background: var(--secondary-blue); color: white; border-radius: 8px 8px 0 0; display: flex; justify-content: space-between; align-items: center; }
  .modal-body { padding: 15px; overflow-y: auto; }
  .modal-footer { padding: 12px 15px; background: #f9f9f9; border-radius: 0 0 8px 8px; display: flex; justify-content: space-between; gap: 10px; }

  .type-selector { display: flex; gap: 8px; margin-bottom: 15px; }
  .type-option { flex: 1; border: 1px solid #ddd; padding: 8px; text-align: center; border-radius: 4px; cursor: pointer; font-size: 0.85rem; }
  .type-option.active-nom { border-color: var(--secondary-blue); background: #ebf5ff; color: var(--secondary-blue); font-weight: bold; }
  .type-option.active-otr { border-color: var(--primary-orange); background: #fff5eb; color: var(--primary-orange); font-weight: bold; }
  .full-width { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }

  /* Event List in Modal */
  .event-list-container { margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; }
  .event-list-title { font-size: 0.75rem; font-weight: bold; color: #666; margin-bottom: 8px; text-transform: uppercase; }
  .event-card { display: flex; justify-content: space-between; align-items: center; background: #fafafa; border: 1px solid #eee; padding: 8px; border-radius: 4px; margin-bottom: 6px; cursor: pointer; transition: all 0.2s; }
  .event-card:hover { border-color: var(--secondary-blue); background: #f0f7ff; }
  .event-card.is-editing { border-color: var(--primary-orange); background: #fff5eb; box-shadow: 0 2px 5px rgba(238, 118, 35, 0.15); }
  .event-card-main { display: flex; align-items: center; gap: 8px; }
  .event-dot { width: 8px; height: 8px; border-radius: 50%; }
  .event-info { font-size: 0.8rem; font-weight: 600; color: #333; }
  .event-val { font-size: 0.75rem; color: #666; }

  /* Mass Controls */
  .mass-controls { display: flex; gap: 8px; margin-bottom: 5px; align-items: center; }
  .mass-check-all { display: flex; align-items: center; gap: 4px; min-width: 60px; }
  .mass-filter { flex: 1; padding: 4px 8px; font-size: 0.75rem; border: 1px solid #ddd; border-radius: 3px; }
  .user-select-list { border: 1px solid #ddd; border-radius: 4px; max-height: 150px; overflow-y: auto; padding: 5px; margin-top: 5px; background: #fafafa; }
  .user-check-item { display: flex; align-items: center; padding: 4px; border-bottom: 1px solid #eee; font-size: 0.8rem; }
  .user-check-item.is-filtered-out { display: none; }
  .user-check-item:last-child { border-bottom: none; }
  .user-check-item input { margin-right: 8px; }

  /* Buttons */
  .btn-save { background: var(--primary-orange); color: white; border: none; padding: 8px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; flex: 1; }
  .btn-cancel { background: white; color: #555; border: 1px solid #ccc; padding: 8px 15px; border-radius: 4px; cursor: pointer; }
  .btn-danger { background: white; color: #c62828; border: 1px solid #c62828; padding: 8px 15px; border-radius: 4px; cursor: pointer; }
  
  .hidden { display: none !important; }
  .loader-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8); z-index: 50; display: flex; justify-content: center; align-items: center; }
  .spinner { width: 30px; height: 30px; border: 3px solid #eee; border-top: 3px solid var(--primary-orange); border-radius: 50%; animation: spin 0.8s linear infinite; }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

  /* --- TOAST NOTIFICATIONS --- */
  .toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 300; display: flex; flex-direction: column; gap: 10px; }
  .toast {
      background: #333; color: white; padding: 12px 20px; border-radius: 6px; font-size: 0.9rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: slideIn 0.3s ease-out; display: flex; align-items: center; gap: 10px;
  }
  .toast.success { background: #2ecc71; color: white; }
  .toast.error { background: #e74c3c; color: white; }
  /* PEGAR EN Stylesheet.html - AL FINAL */

/* Corrección para que el Loader siempre esté POR ENCIMA de los modales */
.loader-overlay {
  z-index: 9999 !important; /* Forzamos que sea la capa superior absoluta */
}

/* Estilo visual para botones deshabilitados */
button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  pointer-events: none; /* Bloquea clics físicos */
}
  @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

  /* --- FIX: COLUMNAS Y ENCABEZADOS FIJOS --- */
  
  /* 1. Definición de Anchos Fijos (Evita que se compriman) */
  .col-contrato { width: 80px;  min-width: 80px;  max-width: 80px; }
  .col-registro { width: 70px;  min-width: 70px;  max-width: 70px; }
  .col-nombre   { width: 260px; min-width: 260px; max-width: 260px; } /* Ancho generoso para nombres */
  .col-puesto   { width: 150px; min-width: 150px; max-width: 150px; }

  /* 2. Lógica Sticky (El ancla) */
  .sticky-col {
    position: sticky !important;
    left: 0; /* Se ajustará con las clases pos-X */
    z-index: 30; /* Nivel base para columnas de datos fijas */
    background-color: #fff; /* Fondo sólido para que no se trasluzca el texto al hacer scroll */
    box-shadow: 2px 0 5px rgba(0,0,0,0.05); /* Sutil sombra divisoria */
  }

  /* 3. Coordenadas Exactas (La matemática del apilamiento horizontal) */
  .pos-1 { left: 0 !important; }
  .pos-2 { left: 80px !important; }  /* Ancho de Contrato */
  .pos-3 { left: 150px !important; } /* 80 + 70 */
  .pos-4 { left: 410px !important; } /* 80 + 70 + 260 */

  /* Borde visual para separar lo fijo del resto de la tabla */
  .pos-4 { border-right: 2px solid #dce1e6 !important; }

  /* 4. GUERRA DE Z-INDEX (Corrección de superposición) */
  
  /* Los encabezados de días (fila 2) y filtros (fila 3) deben estar altos */
  thead tr th { z-index: 20; }
  
  /* PERO las columnas fijas (la intersección esquina superior izq) deben ser SUPREMOS */
  /* Esto evita que los días "tapen" los nombres al scrollear a la derecha */
  thead tr th.sticky-col {
    z-index: 50 !important; 
    background-color: #f1f3f5; /* Mismo gris que el header para continuidad visual */
  }

  /* Corrección específica para el cuadro de "Filtros" en columnas fijas */
  thead tr:nth-child(3) th.sticky-col {
    z-index: 50 !important;
    background-color: #f8f9fa;
  }
  
  /* Corrección para el bloque de "Semanas" (Esquina superior absoluta) */
  thead tr.tr-weeks th.sticky-col {
    z-index: 60 !important; /* El rey de la colina */
    background-color: #eaedf1;
  }

  /* Ajuste para que las celdas de datos (blancas) no tapen cosas indebidas pero tapen el scroll */
  tbody td.sticky-col {
    z-index: 30;
    background-color: #fff;
  }
</style>